/* ============================================================================
 * global.css
 * 
 * Purpose:
 * - Defines theme variables (light/dark) and app-wide styling primitives.
 * - Implements hero background crossfade, card/UI styling, responsive layout,
 *   modal presentation, and small interaction affordances.
 *
 * Notes:
 * - Theme is controlled via the <html data-theme="..."> attribute.
 * - Only animatable properties are transitioned to keep theme toggles smooth.
 * - Masonry-like grids use CSS Grid (blog) and CSS columns (gallery is inline-styled).
 * - Breakpoints target large tablets (≤1200px), tablets (≤912px), and phones (≤640px).
 * ========================================================================== */

/* === Styles === */
/* Light theme tokens (CSS custom properties) */
:root {
  --bg: #fefcf9;
  --fg: #1f1d1a;
  --muted: #576e4e;
  --card: #ffffff85;
  --accent: #405436;
  --border: #e5ebdf;
  --transition-speed: 0.3s;
  --transition-ease: ease-in-out;
}

/* Dark theme tokens applied when html[data-theme='dark'] is present */
html[data-theme='dark'] {
  --bg: #0e1411;
  --fg: #e7efe7;
  --muted: #3f6b44;
  --card: #101814b3;
  --accent: #6ea757;
  --border: #1c2a22;
  --transition-speed: 0.3s;
  --transition-ease: ease-in-out;
}

/* Limit transitions to animatable properties for smoother theme toggles */
* {
  box-sizing: border-box;
  transition:
    color var(--transition-speed) var(--transition-ease),
    background-color var(--transition-speed) var(--transition-ease),
    border-color var(--transition-speed) var(--transition-ease);
}

/* Document sizing: allow natural page growth and scrolling (esp. on mobile) */
html {
  min-height: 100%;
  height: auto;
}

body {
  min-height: 100vh;
  height: auto;
}

#root {
  min-height: 100%;
  height: auto;
}

/* Base page defaults: theme-aware colors + system font stack */
body {
  margin: 0;
  background: var(--bg);
  color: var(--fg);
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, sans-serif;
  overflow: auto;
}

/* ============================================================================
 * Hero background crossfade
 * - Two layered pseudo-elements swap opacity when theme changes.
 * - Positioned behind content using z-index: -1.
 * ========================================================================== */
#root {
  position: relative;
  min-height: 100%;
  overflow: hidden;
}

#root::before,
#root::after {
  content: "";
  position: absolute;
  inset: 0;
  background-size: cover;
  background-position: center;
  transition: opacity var(--transition-speed) var(--transition-ease);
  z-index: -1;
}

#root::before {
  background-image: url('/hero.JPG');
  opacity: 1;
}

#root::after {
  background-image: url('/hero-dark.JPG');
  opacity: 0;
}

html[data-theme='dark'] #root::before {
  opacity: 0;
}

html[data-theme='dark'] #root::after {
  opacity: 1;
}

/* ============================================================================
 * Layout primitives
 * - Sidebar-like profile column + main content area.
 * - Cards are semi-translucent with blur.
 * ========================================================================== */
.layout {
  display: flex;
  gap: 20px;
}

.profile {
  width: 28vw;
  max-width: 360px;
  height: auto;
  max-height: calc(100vh - 40px);
  padding: 20px;
  gap: 20px;
  margin-left: 20px;
  margin-top: 20px;
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 10px;
  backdrop-filter: blur(30px);
  display: flex;
  flex-direction: column;
  overflow: auto;
}

.content {
  flex: 1;
  padding: 20px;
  padding-left: 0;
}

section {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 10px;
}

/* ============================================================================
 * Cards
 * - Main content containers with scrollable bodies where needed.
 * - Image hover adds subtle scale + shadow for affordance.
 * ========================================================================== */
.card {
  height: calc(100vh - 140px);
  width: 100%;
  overflow-y: auto;
  background: var(--card);
  padding: 1rem;
  border: 1px solid var(--border);
  border-radius: 10px;
  backdrop-filter: blur(20px);
}

.card--scroll {
  overflow-y: auto;
  max-height: 100%;
  padding: 1rem;
}

.card img:hover {
  filter: drop-shadow(0 4px 6px rgba(0, 0, 0, .3));
  transform: scale(1.02);
  transition: transform .3s ease, filter .3s ease;
  cursor: pointer;
}

/* ============================================================================
 * Form controls and buttons
 * - Button variants: default, .active (primary), .ghost (outlined accent).
 * - Hover states unify on var(--muted) for consistent emphasis.
 * ========================================================================== */
button,
input,
select,
textarea {
  font: inherit;
  color: inherit;
}

button {
  padding: .6rem .9rem;
  border-radius: 10px;
  cursor: pointer;
  background: transparent;
  color: var(--fg);
  border: 1px solid var(--border);
}

button:hover {
  background: var(--muted);
  color: #fff;
  border-color: var(--muted);
}

button.active {
  background: var(--accent);
  color: #fff;
  border-color: var(--accent);
}

button.active:hover {
  background: var(--muted);
  color: #fff;
  border-color: var(--muted);
}

button.ghost {
  background: transparent;
  color: var(--accent);
  border: 1px solid var(--accent);
}

button.ghost:hover,
button.ghost.active:hover {
  background: var(--muted);
  color: #fff;
  border-color: var(--muted);
}

button.ghost.active {
  background: var(--accent);
  color: #fff;
  border-color: var(--accent);
}

button:disabled {
  opacity: .6;
  cursor: not-allowed;
}

/* Navigation bar with tab-like buttons (flex layout, wraps on small screens) */
nav {
  border: 1px solid var(--border);
  border-radius: 10px;
  padding: 1rem;
  background: var(--card);
  margin-bottom: 20px;
  height: 80px;
  backdrop-filter: blur(30px);
}

nav.tabs {
  display: flex;
  gap: .5rem;
  flex-wrap: wrap;
}

nav.tabs button {
  background: transparent;
  color: var(--fg);
  border: 1px solid var(--border);
  flex: 0 1 auto;
}

nav.tabs button.active {
  background: var(--accent);
  color: #fff;
  border-color: var(--accent);
}

nav.tabs button:hover,
nav.tabs button.active:hover {
  background: var(--muted);
  color: #fff;
  border-color: var(--muted);
}

/* ============================================================================
 * Tables & Inputs
 * - Tables scroll horizontally on small screens (no layout break).
 * - Inputs use neutral light background for readability across themes.
 * ========================================================================== */
.card table {
  width: 100%;
  border-collapse: collapse;
  display: block;
  overflow-x: auto;
  white-space: nowrap;
}

.input {
  margin: 8px 0;
  width: 100%;
  padding: .6rem .7rem;
  border-radius: 10px;
  border: 1px solid #d4d4d8;
  background: #fff;
  color: #111;
}

/* ============================================================================
 * Tags
 * - Pills used throughout Blog/Gallery for metadata and filters.
 * ========================================================================== */
.tag {
  padding: 2px 8px;
  border-radius: 999px;
  border: 1px solid #d4d4d8;
  display: inline-flex;
  align-items: center;
  gap: 4px;
}

.tags {
  display: flex;
  gap: .5rem;
  flex-wrap: wrap;
  margin-bottom: 10px;
}

/* ============================================================================
 * Blog / Posts grid
 * - 3-column grid on desktop, collapses via breakpoints below.
 * - Card hover adds gentle elevation and translateY for interactivity.
 * ========================================================================== */
.list {
  display: grid;
  grid-template-columns: repeat(3, minmax(260px, 1fr));
  gap: 1rem;
}

.post {
  background: var(--card);
  padding: 1rem;
  border: 1px solid var(--border);
  border-radius: 10px;
}

.post:hover {
  box-shadow: 0 10px 30px rgba(0, 0, 0, .15);
  transform: translateY(-2px);
  transition: transform .3s ease, box-shadow .3s ease;
  cursor: pointer;
}

/* Post images are centered and constrained within the card */
.post img {
  display: block;
  width: auto;
  max-width: 100%;
  height: auto;
  object-fit: fill;
  border-radius: 12px;
  border: 1px solid var(--border);
  margin: 15px auto 0;
}

/* ============================================================================
 * Modal system
 * - .modal-overlay covers the viewport; .modal is the content container.
 * - .modal--lg variant is used by the Blog post detail view.
 * ========================================================================== */
.modal-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, .5);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 9999;
}

.modal {
  width: min(520px, 92vw);
  background: var(--card);
  backdrop-filter: blur(20px);
  color: var(--fg);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 1rem;
  box-shadow: 0 10px 30px rgba(0, 0, 0, .35);
}

.modal__header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: .5rem;
  margin-bottom: .5rem;
}

.modal__tabs {
  display: inline-flex;
  gap: .5rem;
}

.modal__body {
  display: grid;
  gap: .6rem;
}

.modal input {
  width: 100%;
}

/* Large modal variant for post view */
.modal--lg {
  width: min(900px, 96vw);
  max-height: 90vh;
  overflow: auto;
}

.modal--lg .post-modal__title {
  margin: 0 0 .25rem 0;
}

.modal--lg .post-modal__meta {
  opacity: .7;
  margin-bottom: .75rem;
  display: block;
}

.modal--lg .post-modal__img {
  width: auto;
  max-height: 60vh;
  object-fit: fill;
  border-radius: 10px;
  margin: 0 auto .75rem auto;
  display: block;
}

.modal--lg .post-modal__body {
  white-space: pre-wrap;
  line-height: 1.5;
}

.modal--lg .post-modal__tags {
  display: flex;
  gap: .5rem;
  flex-wrap: wrap;
  margin-top: .75rem;
}

/* ============================================================================
 * Editable affordances
 * - .editable areas get dashed borders on hover when editable.
 * - .edit-chip provides a small visual marker (✎) near editable labels.
 * ========================================================================== */
.editable {
  position: relative;
  border: 1px dashed transparent;
  border-radius: 8px;
  padding: 4px 6px;
}

.editable--enabled {
  cursor: pointer;
}

.editable--enabled:hover {
  border-color: var(--accent);
  background: color-mix(in oklab, var(--accent) 12%, transparent);
}

.edit-chip {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  margin-left: 8px;
  padding: 2px 8px;
  border-radius: 999px;
  border: 1px solid var(--accent);
  color: var(--accent);
  font-size: 12px;
}

.edit-chip::before {
  content: '✎';
}

/* ====== Breakpoints ====== */
/* Large tablets / small desktops: slightly widen profile and reduce blog columns */
@media (max-width: 1200px) {
  .profile {
    width: 32vw;
  }

  .list {
    grid-template-columns: repeat(2, minmax(240px, 1fr));
  }
}

/* Tablets: stack layout; relax fixed heights so content can grow/scroll */
@media (max-width: 912px) {
  .layout {
    flex-direction: column;
    overscroll-behavior: hidden;
    overflow: visible;
  }

  .profile {
    position: static;
    width: 95%;
    max-width: none;
    height: auto;
    margin: 10px 20px 0;
  }

  .content {
    padding: 10px 20px;
  }

  .card {
    height: auto;
    max-height: none;
    overflow: hidden;
  }
}

/* Phones: denser spacing, wrapped nav tabs, single-column blog list */
@media (max-width: 640px) {
  .layout {
    gap: 10px;
  }

  nav {
    height: 180px;
  }

  nav.tabs {
    gap: .4rem;
  }

  nav.tabs button {
    flex: 1 1 calc(50% - .4rem);
  }

  .list {
    grid-template-columns: 1fr;
  }

  .post img {
    max-width: 100%;
  }

  /* iOS viewport quirk: ensure body expands with on-screen keyboard */
  @supports (-webkit-touch-callout: none) {
    body {
      min-height: -webkit-fill-available;
    }
  }
}